---
title: "Aphid Survival under Pseudomonas Ingestion Analysis"
date: "2024 Summer"
output:
  html_document:
    css: ../css/tufte.css
    toc: true
    toc_float: true
  pdf_document:
    toc: true
  word_document:
    toc: true
    reference_docx: templates/wordstyletemplate.docx
    keep_md: true
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy.opts = list(width.cutoff = 60), tidy = TRUE)
```

# Load Libraries

```{r load-packages}
pacman::p_load(survival, here, tibble, ggplot2, readxl, ggbeeswarm, dplyr, tidyverse, cowplot, knitr, lubridate, ggsurvfit, gtsummary, tidycmprsk, install = FALSE)
```

# Load Data

```{r load-data}
aphid_virulence_data <- read_csv("~/Desktop/Cornell/Hendry Lab/pseud-epi-growth/others_data/virulence_new_all.csv")
```

# Goals

- Create Kaplan-Meier curve for Pseud. virulence data
- Use stats (Wilcox?) to determine statistical significance of each strain
- Compare virulence data with epiphitic growth ability

# Analysis

Note: *In order to help me with this analysis, I am using the following sites - [Survival Analysis in R
](https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html) and [Hazard Ratio: Interpretation & Definition](https://statisticsbyjim.com/probability/hazard-ratio/).*

## Subset Data

```{r subset-data-cit7}
cit7_data <- subset(aphid_virulence_data, treatment == "Cit7")
```

## Testing `survival` package

```{r test-survival}
Surv(cit7_data$time, cit7_data$censored)[1:10]
```

## Make Kaplan-Meier Plot

### Cohort Survival Curve

```{r Kaplan-Meier}
survfit2(Surv(time, censored) ~ treatment, data = aphid_virulence_data) %>% 
  ggsurvfit() +
  labs(
    x = "Days",
    y = "Overall survival probability"
  )
```